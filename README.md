# finable Account Management API

A new kind of money system, that's clear, safe and fair.
It's a secure, TypeScript-based RESTful API for account and card data handling, using Node.js, Express, Mongoose (MongoDB), and AES encryption.
[Link to published postman documentation](https://documenter.getpostman.com/view/42790271/2sB2qcBzrK)

[Link to complete Postman API Documentation](https://www.postman.com/technical-astronomer-46430310/public/collection/mjrlrcm/finacle?action=share&creator=42790271)

## Features

1. Account creation with autogenerated:

   - Unique account number

   - Visa card number, CVV, and expiry date

2. Encryption of sensitive fields:

   - Phone number

   - Date of birth

   - Card details (number, CVV, expiry)

3. Decryption endpoint for securely reading stored data

4. Input validation (basic, customizable with Zod)

5. Structured using MVC architecture

## Tech Stack

| Tech       | Description                     |
| ---------- | ------------------------------- |
| Node.js    | JavaScript runtime              |
| Express.js | Web framework                   |
| MongoDB    | NoSQL database                  |
| Mongoose   | ODM for MongoDB                 |
| TypeScript | Type safety                     |
| dotenv     | Environment variable management |
| AES-256    | Encryption of sensitive fields  |

## Encryption

### Fields Encrypted:

- Phone number

- Date of birth

- Card details

## Utils

- encrypt(plainText: string): string
- decrypt(cipherText: string): string
  Uses symmetric AES-256 encryption with a secret key stored in .env.

## API Endpoints

### Base URL: /api

| Method | Endpoint                         | Description                            |
| ------ | -------------------------------- | -------------------------------------- |
| `GET`  | `/`                              | Health check                           |
| `POST` | `/account`                       | Create a new account                   |
| `GET`  | `/account`                       | Get all encrypted accounts             |
| `GET`  | `/account/decrypted`             | Get all accounts with decrypted fields |
| `GET`  | `/account/encryptedanddecrypted` | Get both encrypted and decrypted views |

### Account Creation

#### Sample Data Sent

```
{
    "firstName": "Joseph",
    "surname": "Uche",
    "email": "uche.ejike.123@gmail.com",
    "phoneNumber": "08154496583",
    "dateOfBirth": "18-11-2025"
}
```

#### Sample Response Received from Server

```
{
    "firstName": "Joseph",
    "surname": "Uche",
    "fullName": "Joseph Uche",
    "email": "uche.ejike.123@gmail.com",
    "phoneNumber": "5f31e70ed511e296e71e0ed219c4783c:79aa866d0509c465db79b6b818022bd8",
    "dateOfBirth": "9d37dcd33175998e32be67aa74b4fc9f:3e3c819343640c35ad662f25f477f8d2",
    "accountNumber": "2005706611",
    "card": {
        "cardNumber": "5937594779097c46e6a797e7c0af6d97:52b6758ded3ec882750338db105a920d9e10b4115dd8e9b8c1fab0286a7a5bf0",
        "CVV": "d3d9ba894c702463177d84dafe355f44:bb921e6ace1197425cc4e003ba028c63",
        "expiryDate": "05/28",
        "_id": "68313432c877a1ae63621718"
    },
    "_id": "68313432c877a1ae63621717",
    "__v": 0
}
```

#### Sample Error

```
{
    "message": "invalid input",
    "errors": [
        {
            "code": "invalid_type",
            "expected": "string",
            "received": "undefined",
            "path": [
                "dateOfBirth"
            ],
            "message": "Required"
        }
    ]
}
```

#### Decryption

Returns decrypted data:

```
[
    {
        "_id": "682e0e50570fa1a7c0d657b0",
        "firstName": "Joseph",
        "surname": "Uche",
        "fullName": "Joseph Uche",
        "email": "uche.ejike.123@gmail.com",
        "phoneNumber": "08154496583",
        "dateOfBirth": "18-11-2025",
        "accountNumber": "2034780625",
        "card": {
            "cardNumber": "4719401504590748",
            "CVV": "648",
            "expiryDate": "05/28"
        },
        "__v": 0
    }
]
```

## Environment Variables

Create a .env file at the root:

```
PORT=3000
MONGO_URI=your-mongodb-url
ENC_KEY=your-256-bit-secret-key (must be 64 in length else you'll get an error)
```
